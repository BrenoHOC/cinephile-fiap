[
    {
        "id": "8c761bcddb6e0b85",
        "type": "tab",
        "label": "Fluxo de login_teste",
        "disabled": false,
        "info": "Neste consta os fluxos de cadastro e login do usuário",
        "env": []
    },
    {
        "id": "aa0e170c91379e2f",
        "type": "tab",
        "label": "Fluxo de Seleção de Filmes",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "c4bb2b1dcfa16364",
        "type": "tab",
        "label": "css",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "ddef06d8d0048305",
        "type": "global-config",
        "name": "global-config",
        "env": []
    },
    {
        "id": "efbcd60e6a02a05e",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Sua Plataforma de gerenciamento de filmes",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "false",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "8a77e8fa5a34a8c0",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "be1439f3a0ba43d1",
        "type": "ui_group",
        "name": "Seleção de filmes",
        "tab": "8a77e8fa5a34a8c0",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "9b81770e912bf6fa",
        "type": "ui_group",
        "name": "Dados do filme",
        "tab": "8a77e8fa5a34a8c0",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "a1189548f1bad27e",
        "type": "ui_tab",
        "name": "login",
        "icon": "login",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "b77ad3d3025c33ce",
        "type": "ui_group",
        "name": "Criar login",
        "tab": "fad7740d4433ba8a",
        "order": 1,
        "disp": false,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "a6d03c119ba764d7",
        "type": "ui_group",
        "name": "login",
        "tab": "a1189548f1bad27e",
        "order": 2,
        "disp": false,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "fad7740d4433ba8a",
        "type": "ui_tab",
        "name": "Criar login",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "9d61c4da23fb66b7",
        "type": "ui_group",
        "name": "Transição",
        "tab": "a1189548f1bad27e",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "1d0da4a58b5848a4",
        "type": "ui_group",
        "name": "Transição",
        "tab": "8a77e8fa5a34a8c0",
        "order": 3,
        "disp": true,
        "width": 50,
        "collapse": false,
        "className": ""
    },
    {
        "id": "96e76148eab11ebb",
        "type": "ui_group",
        "name": "Transição",
        "tab": "fad7740d4433ba8a",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "639665f5f0a31743",
        "type": "ui_group",
        "name": "Sinopse",
        "tab": "8a77e8fa5a34a8c0",
        "order": 4,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "cf21394ef4fb9045",
        "type": "JsonWebToken_config",
        "name": "token_autenticação",
        "secret": "2d96cd0c-630f-11ee-8c99-0242ac120002"
    },
    {
        "id": "1aa635ca051d2e8f",
        "type": "ui_form",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "label": "Criar login",
        "group": "b77ad3d3025c33ce",
        "order": 1,
        "width": "6",
        "height": 3,
        "options": [
            {
                "label": "e-mail",
                "value": "user",
                "type": "text",
                "required": true,
                "rows": null
            },
            {
                "label": "senha",
                "value": "password",
                "type": "password",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "user": "",
            "password": ""
        },
        "payload": "",
        "submit": "Criar usuário",
        "cancel": "",
        "topic": "topic",
        "topicType": "msg",
        "splitLayout": false,
        "className": "",
        "x": 110,
        "y": 80,
        "wires": [
            [
                "539e6237d2a1eacd"
            ]
        ]
    },
    {
        "id": "539e6237d2a1eacd",
        "type": "function",
        "z": "8c761bcddb6e0b85",
        "name": "gera hash",
        "func": "const bcrypt = global.get('bcrypt');\n\nasync function gerarHashSenha(senha) {\n  return await bcrypt.hash(senha, 10)\n    .then(hash => hash)\n    .catch(err => {\n      throw err;\n    });\n}\n\nlet senhaEncriptografada = null;\n\nif(msg.payload.password) {\n  senhaEncriptografada = await gerarHashSenha(msg.payload.password)\n    .then(hash => hash)\n    .catch(err => console.log(err));\n}\n\nmsg.payload = {\n    user: msg.payload.user,\n    password: senhaEncriptografada,\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [
            {
                "var": "moment",
                "module": "moment"
            }
        ],
        "x": 260,
        "y": 140,
        "wires": [
            [
                "90c457ab36450022",
                "b9db7e3b541cb6fb"
            ]
        ],
        "info": "## Gera hash antes de persistir os do usuário"
    },
    {
        "id": "49ca71d5d633e0db",
        "type": "inject",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "props": [
            {
                "p": "payload.user",
                "v": "breno.hoc3+3@gmail.com",
                "vt": "str"
            },
            {
                "p": "payload.password",
                "v": "123456",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "x": 110,
        "y": 200,
        "wires": [
            [
                "683c13c89c971e85"
            ]
        ]
    },
    {
        "id": "b9db7e3b541cb6fb",
        "type": "http request",
        "z": "8c761bcddb6e0b85",
        "name": "Salvar Dados Usuário",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "${API_SERVER_AUTH}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "apikey",
                "valueType": "other",
                "valueValue": "${API_SERVER_AUTH_TOKEN}"
            }
        ],
        "x": 460,
        "y": 80,
        "wires": [
            [
                "9f713da3cb631cf9"
            ]
        ]
    },
    {
        "id": "b3dd0e3bb6f1175d",
        "type": "ui_form",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "label": "Login",
        "group": "a6d03c119ba764d7",
        "order": 2,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "E-mail",
                "value": "email",
                "type": "text",
                "required": true,
                "rows": null
            },
            {
                "label": "Senha",
                "value": "password",
                "type": "password",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "email": "",
            "password": ""
        },
        "payload": "",
        "submit": "Entrar",
        "cancel": "",
        "topic": "topic",
        "topicType": "msg",
        "splitLayout": "",
        "className": "",
        "x": 70,
        "y": 880,
        "wires": [
            [
                "8b2ea290429fdb46"
            ]
        ]
    },
    {
        "id": "db0c71139f912f09",
        "type": "ui_template",
        "z": "8c761bcddb6e0b85",
        "group": "b77ad3d3025c33ce",
        "name": "Já possui cadastro?",
        "order": 2,
        "width": 0,
        "height": 0,
        "format": "<div>\n    <button class=\"w md-raised nr-dashboard-form-button md-button md-ink-ripple\"\n    ng-click=\"send({payload: {login: true}})\">\n        Já possui cadastro?\n    </button>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 140,
        "y": 480,
        "wires": [
            [
                "2c6cab8a13ce9c94"
            ]
        ]
    },
    {
        "id": "d6b8783744e1667e",
        "type": "http request",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "body",
        "url": "{{{payload.url}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "apikey",
                "valueType": "other",
                "valueValue": "${API_SERVER_AUTH_TOKEN}"
            }
        ],
        "x": 600,
        "y": 960,
        "wires": [
            [
                "b397302016ddb6f1"
            ]
        ]
    },
    {
        "id": "b397302016ddb6f1",
        "type": "function",
        "z": "8c761bcddb6e0b85",
        "name": "Compare hash",
        "func": "const bcrypt = global.get('bcrypt');\n\nconst senha = flow.get('password');\n\nmsg.payload = JSON.parse(msg.payload);\n\nconst senhaHash = msg.payload[0]?.password;\n\nif(!senhaHash) {\n  msg.payload.auth = false;\n\n  return msg;\n}\n\nasync function comparaSenhaComHash(senha, senhaHash) {\n  return await bcrypt.compare(senha, senhaHash)\n    .then(result => result)\n    .catch(err => {\n      throw err;\n    });\n}\n\nconst senhaComparada = await comparaSenhaComHash(senha, senhaHash)\n  .then(hash => hash)\n  .catch(err => console.log(err));\n\nmsg.payload = {\n  auth: senhaComparada,\n  id: msg.payload[0]?.id_auth,\n  email: msg.payload[0]?.user\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 740,
        "y": 880,
        "wires": [
            [
                "1379875dafca6313"
            ]
        ],
        "info": "## Compara senha do usuário com a cadastrada"
    },
    {
        "id": "3b61f912a0d768c3",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "password",
                "pt": "flow",
                "to": "payload.password",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 880,
        "wires": [
            [
                "d6b8783744e1667e"
            ]
        ]
    },
    {
        "id": "550a2a50d314e659",
        "type": "comment",
        "z": "8c761bcddb6e0b85",
        "name": "Página de criação de login",
        "info": "",
        "x": 530,
        "y": 40,
        "wires": []
    },
    {
        "id": "b72b13fd29e6c9a3",
        "type": "ui_ui_control",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "events": "all",
        "x": 620,
        "y": 520,
        "wires": [
            [
                "5f341e662685b1d0"
            ]
        ]
    },
    {
        "id": "2c6cab8a13ce9c94",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "Carregar pag Login",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "login",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 410,
        "y": 480,
        "wires": [
            [
                "b72b13fd29e6c9a3"
            ]
        ]
    },
    {
        "id": "ec0d9e79045ac233",
        "type": "ui_template",
        "z": "8c761bcddb6e0b85",
        "group": "a6d03c119ba764d7",
        "name": "Criar cadastro?",
        "order": 3,
        "width": 0,
        "height": 0,
        "format": "<div>\n    <button class=\"w md-raised nr-dashboard-form-button md-button md-ink-ripple\"\n    ng-click=\"send({payload: {criarLogin: true}})\">\n        Criar cadastro\n    </button>\n</div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "teste123",
        "x": 120,
        "y": 560,
        "wires": [
            [
                "a98292bc7dd4bef1"
            ]
        ]
    },
    {
        "id": "a98292bc7dd4bef1",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "Carregar pag Criar Login",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Criar login",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 390,
        "y": 560,
        "wires": [
            [
                "b72b13fd29e6c9a3"
            ]
        ]
    },
    {
        "id": "fc7069d8b435ca6c",
        "type": "comment",
        "z": "8c761bcddb6e0b85",
        "name": "Transições entre telas",
        "info": "Transições entre as telas",
        "x": 520,
        "y": 380,
        "wires": []
    },
    {
        "id": "1379875dafca6313",
        "type": "switch",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "property": "payload.auth",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "false"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 950,
        "y": 880,
        "wires": [
            [
                "7f285f1c2d6ead66",
                "5957c1b77a7435d8"
            ],
            [
                "43c388c9d0a49229"
            ]
        ]
    },
    {
        "id": "7f285f1c2d6ead66",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "Carregar pag Home",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Home",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1140,
        "y": 800,
        "wires": [
            [
                "eab0bb594305e2bc"
            ]
        ]
    },
    {
        "id": "eab0bb594305e2bc",
        "type": "ui_ui_control",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "events": "all",
        "x": 1360,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "561cf3d3044e200b",
        "type": "ui_toast",
        "z": "8c761bcddb6e0b85",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1370,
        "y": 960,
        "wires": [
            []
        ]
    },
    {
        "id": "43c388c9d0a49229",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "Msg Login Inválido",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Login inválido",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1130,
        "y": 960,
        "wires": [
            [
                "561cf3d3044e200b"
            ]
        ]
    },
    {
        "id": "67c72f5a3755b7ed",
        "type": "e-mail",
        "z": "8c761bcddb6e0b85",
        "server": "smtp-mail.outlook.com",
        "port": "587",
        "authtype": "BASIC",
        "saslformat": true,
        "token": "oauth2Response.access_token",
        "secure": false,
        "tls": true,
        "name": "",
        "dname": "envio de email",
        "x": 800,
        "y": 280,
        "wires": [],
        "info": "As configurações precisam estar nas variáveis de amviente"
    },
    {
        "id": "90c457ab36450022",
        "type": "function",
        "z": "8c761bcddb6e0b85",
        "name": "Conteudo E-mail",
        "func": "\nmsg.to = msg.payload.user\nmsg.from =\"GrupoPFiap@outlook.com\"\nmsg.topic =\"Usuario criado com Sucesso\"\nmsg.payload=`Olá,\\n Seu usuario foi criado com sucesso no projeto do Grupo P \\n Obrigado por Participar`\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "// Login: GrupoPFiap@outlook.com\n// Senha: GrupoP1234\n",
        "finalize": "",
        "libs": [],
        "x": 470,
        "y": 280,
        "wires": [
            [
                "67c72f5a3755b7ed"
            ]
        ]
    },
    {
        "id": "df1d6324a71cfdce",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "global",
                "to": "token",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1390,
        "y": 880,
        "wires": [
            []
        ]
    },
    {
        "id": "5f341e662685b1d0",
        "type": "switch",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "property": "token",
        "propertyType": "global",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 830,
        "y": 520,
        "wires": [
            [
                "e7312a2f5c02af11"
            ],
            [
                "af85a7af918962c9"
            ]
        ]
    },
    {
        "id": "e7312a2f5c02af11",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "login",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1050,
        "y": 480,
        "wires": [
            [
                "1d59c54c5cbccfb5"
            ]
        ]
    },
    {
        "id": "af85a7af918962c9",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "token",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1050,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "1d59c54c5cbccfb5",
        "type": "ui_ui_control",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "events": "all",
        "x": 1260,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "d270f04e12a24c43",
        "type": "comment",
        "z": "8c761bcddb6e0b85",
        "name": "Página de login",
        "info": "",
        "x": 520,
        "y": 660,
        "wires": []
    },
    {
        "id": "683c13c89c971e85",
        "type": "function",
        "z": "8c761bcddb6e0b85",
        "name": "function 1",
        "func": "msg = {\"_msgid\":\"afac75bfd9a60f55\",\"payload\":\"\",\"statusCode\":201,\"headers\":{\"date\":\"Mon, 09 Oct 2023 23:15:38 GMT\",\"transfer-encoding\":\"chunked\",\"connection\":\"close\",\"content-range\":\"*/*\",\"cf-ray\":\"813a53a3c9451d4e-GIG\",\"cf-cache-status\":\"DYNAMIC\",\"access-control-allow-origin\":\"*\",\"strict-transport-security\":\"max-age=2592000; includeSubDomains\",\"via\":\"kong/2.8.1\",\"sb-gateway-version\":\"1\",\"x-kong-proxy-latency\":\"1\",\"x-kong-upstream-latency\":\"20\",\"server\":\"cloudflare\",\"alt-svc\":\"h3=\\\":443\\\"; ma=86400\",\"x-node-red-request-node\":\"68fcf2d6\"},\"responseUrl\":\"https://qazlfsxxnbvcupqtqqxf.supabase.co/rest/v1/ctj_autorizacao\",\"redirectList\":[],\"retry\":0}\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 480,
        "y": 200,
        "wires": [
            [
                "9f713da3cb631cf9"
            ]
        ]
    },
    {
        "id": "18fa717564305b21",
        "type": "ui_ui_control",
        "z": "8c761bcddb6e0b85",
        "name": "",
        "events": "all",
        "x": 840,
        "y": 40,
        "wires": [
            []
        ]
    },
    {
        "id": "9f713da3cb631cf9",
        "type": "change",
        "z": "8c761bcddb6e0b85",
        "name": "Carregar pag Login",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "login",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 140,
        "wires": [
            [
                "18fa717564305b21"
            ]
        ]
    },
    {
        "id": "8b2ea290429fdb46",
        "type": "function",
        "z": "8c761bcddb6e0b85",
        "name": "define url cadastro login",
        "func": "const API_SERVER_AUTH = env.get(\"API_SERVER_AUTH\")\n\nconst email = encodeURIComponent(msg.payload.email);\n\nmsg.payload.url = `${API_SERVER_AUTH}?user=eq.${email}&select=*`;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 230,
        "y": 940,
        "wires": [
            [
                "3b61f912a0d768c3"
            ]
        ]
    },
    {
        "id": "5957c1b77a7435d8",
        "type": "JsonWebToken",
        "z": "8c761bcddb6e0b85",
        "name": "jwt",
        "tokenconfig": "cf21394ef4fb9045",
        "x": 1170,
        "y": 880,
        "wires": [
            [
                "df1d6324a71cfdce"
            ]
        ]
    },
    {
        "id": "4840eedf5837a3bc",
        "type": "comment",
        "z": "8c761bcddb6e0b85",
        "name": "Fluxo para verificar se o usuário está logado",
        "info": "",
        "x": 630,
        "y": 1100,
        "wires": []
    },
    {
        "id": "c07c868cfcee5e29",
        "type": "ui_form",
        "z": "aa0e170c91379e2f",
        "name": "",
        "label": "",
        "group": "be1439f3a0ba43d1",
        "order": 1,
        "width": 0,
        "height": 0,
        "options": [
            {
                "label": "Nome do filme",
                "value": "movieName",
                "type": "text",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "movieName": ""
        },
        "payload": "",
        "submit": "Pesquisar",
        "cancel": "",
        "topic": "topic",
        "topicType": "msg",
        "splitLayout": false,
        "className": "",
        "x": 70,
        "y": 140,
        "wires": [
            [
                "a4eb3f59a2b5cb7f"
            ]
        ]
    },
    {
        "id": "20505872b4e45f34",
        "type": "http request",
        "z": "aa0e170c91379e2f",
        "name": "GET filmes",
        "method": "GET",
        "ret": "obj",
        "paytoqs": "ignore",
        "url": "{{{payload.url}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [
            {
                "keyType": "other",
                "keyValue": "Authorization",
                "valueType": "msg",
                "valueValue": "payload.token"
            }
        ],
        "x": 430,
        "y": 140,
        "wires": [
            [
                "34d013ba59765ca4"
            ]
        ]
    },
    {
        "id": "f6c4b9a8fdc8f806",
        "type": "inject",
        "z": "aa0e170c91379e2f",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 140,
        "y": 240,
        "wires": [
            [
                "e45f666c33227137"
            ]
        ]
    },
    {
        "id": "34d013ba59765ca4",
        "type": "function",
        "z": "aa0e170c91379e2f",
        "name": "itera os resultados",
        "func": "msg.payload = msg.payload.results[0];\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 180,
        "wires": [
            [
                "51f0a59a455eee50",
                "28aff7a9fc2f64d4",
                "824ccd2f271148e9"
            ]
        ]
    },
    {
        "id": "51f0a59a455eee50",
        "type": "ui_text",
        "z": "aa0e170c91379e2f",
        "group": "9b81770e912bf6fa",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Título",
        "format": "{{msg.payload.title}}",
        "layout": "row-spread",
        "className": "",
        "style": false,
        "font": "",
        "fontSize": 16,
        "color": "#000000",
        "x": 850,
        "y": 60,
        "wires": []
    },
    {
        "id": "28aff7a9fc2f64d4",
        "type": "ui_template",
        "z": "aa0e170c91379e2f",
        "group": "639665f5f0a31743",
        "name": "",
        "order": 1,
        "width": "6",
        "height": "6",
        "format": "<div ng-bind-html=\"msg.payload.overview\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 880,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "e45f666c33227137",
        "type": "template",
        "z": "aa0e170c91379e2f",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "json",
        "syntax": "mustache",
        "template": "{\n    \"page\": 1,\n    \"results\": [\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/A55WRPRK73zx1cuULDkdX4vriDO.jpg\",\n            \"genre_ids\": [\n                35,\n                28\n            ],\n            \"id\": 22599,\n            \"original_language\": \"en\",\n            \"original_title\": \"Staer\",\n            \"overview\": \"The Driver now carries an arrogant rock star who is visiting a major city (not Pittsburgh as earlier believed). Played by Madonna, this title character wants to get away from her bodyguards in the Driver's BMW. He soon gets tired of her and decides to have a bit of fun.\",\n            \"popularity\": 7.492,\n            \"poster_path\": \"/zslEgrYEg6EDzOYrr8EfDoQK8j1.jpg\",\n            \"release_date\": \"2001-06-01\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 6.837,\n            \"vote_count\": 245\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/m7hBkOBJomzIhbet60b6x4RTBRk.jpg\",\n            \"genre_ids\": [\n                18,\n                10402,\n                10749\n            ],\n            \"id\": 52959,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star!\",\n            \"overview\": \"Drama musical baseado na vida (dentro e fora dos palcos) da atriz britânica Gertrude Lawrence.\",\n            \"popularity\": 8.406,\n            \"poster_path\": \"/xMyOm5hLWeuoWBea1DJrcJy8bU6.jpg\",\n            \"release_date\": \"1968-07-18\",\n            \"title\": \"A Estrela\",\n            \"video\": false,\n            \"vote_average\": 6.482,\n            \"vote_count\": 112\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/a1lMRUeGozBAczWaSoU1p3zLmGs.jpg\",\n            \"genre_ids\": [\n                10749,\n                18\n            ],\n            \"id\": 136244,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star\",\n            \"overview\": \"When Crystal Wyatt was 16 her father passed away. From that time her life would never be the same. Crystal is banished from the family ranch, and starts a new life as a singer in a San Francisco nightclub.\",\n            \"popularity\": 8.122,\n            \"poster_path\": \"/jYmt7JBvAmRJ0FxPx2UayOQ1uOB.jpg\",\n            \"release_date\": \"1993-09-20\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 6.008,\n            \"vote_count\": 118\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/osHpQQ5rcbmH41I4LQlPlprRGpk.jpg\",\n            \"genre_ids\": [\n                18,\n                10751\n            ],\n            \"id\": 125225,\n            \"original_language\": \"hi\",\n            \"original_title\": \"Star\",\n            \"overview\": \"Dev Kumar Verma comes from a middle-class family and must find employment to support his dad and mom. Dev, however, has set his mind upon becoming a music sensation like Elvis Presley. He loses his job because of this, and refuses to work until and unless he gets a job to his liking, much to the dismay of his parents and his brother, Shiv Kumar. Dev does get employment at Charlie's Disco, where he meets with Maya and falls in love with her.  When Charlie's Disco's competitor, Rana, finds out about Dev, he wants to hire Dev, but Dev decides to continue to work with Charlie's Disco, as a result Dev and Charlie get a beating by Rana's men, and Dev is unable to sing. After recuperating, Dev is devastated to find out that Maya and Shiv Kumar are in love with each other. What impact will this have on Dev and his brother on one hand, and what of his career in music?\",\n            \"popularity\": 3.78,\n            \"poster_path\": \"/pU7oXmVdNPrzj2XOGIQ6ciMnH42.jpg\",\n            \"release_date\": \"1982-10-22\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 5.721,\n            \"vote_count\": 52\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/zDImYTJiECn1b79segxKr382DSe.jpg\",\n            \"genre_ids\": [\n                18\n            ],\n            \"id\": 449430,\n            \"original_language\": \"fr\",\n            \"original_title\": \"Star\",\n            \"overview\": \"Star is a young graffiti writer, the best in his city, Paris. His reputation attracts him as much into art galleries than in the police precincts. Accused of vandalism, he faces jail. Despite the threat, he decides to go to Rome with his crew in search of the meaning of his art.\",\n            \"popularity\": 3.081,\n            \"poster_path\": \"/zeGcw5pPVT4DhHrSLUDxE58QJQn.jpg\",\n            \"release_date\": \"2017-04-03\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 5.891,\n            \"vote_count\": 32\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": null,\n            \"genre_ids\": [\n                18\n            ],\n            \"id\": 812434,\n            \"original_language\": \"it\",\n            \"original_title\": \"Star\",\n            \"overview\": \"Giacomo is a low-level actor and voice actor with a great passion for acting. After another disappointing audition he has one last chance to get the part assigned\",\n            \"popularity\": 2.072,\n            \"poster_path\": \"/4oObDGDhycViadrRCC2XJwwXAcR.jpg\",\n            \"release_date\": \"2019-12-19\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 6.281,\n            \"vote_count\": 32\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": null,\n            \"genre_ids\": [\n                99,\n                10402\n            ],\n            \"id\": 719316,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star\",\n            \"overview\": \"Documentary short film and music video for MIKAL's song \\\"Star\\\", comprised of footage of the actual recording process of the song itself.\",\n            \"popularity\": 2.567,\n            \"poster_path\": \"/5o0GyNlILqVxfteo7l31wB5qD2X.jpg\",\n            \"release_date\": \"2017-01-23\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 6.267,\n            \"vote_count\": 31\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": null,\n            \"genre_ids\": [\n                18\n            ],\n            \"id\": 1050338,\n            \"original_language\": \"fr\",\n            \"original_title\": \"Star\",\n            \"overview\": \"Star follows the path of Tito and Jay, two brothers living in the Montreal neighborhood of Park Extension. Accompanying these young people in their daily life marked by complicity and intimidation, Star tackles themes dear to teenagers: identity and friendship.\",\n            \"popularity\": 2.011,\n            \"poster_path\": null,\n            \"release_date\": \"\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 6.3,\n            \"vote_count\": 29\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": null,\n            \"genre_ids\": [],\n            \"id\": 611791,\n            \"original_language\": \"fr\",\n            \"original_title\": \"Star\",\n            \"overview\": \"Star follows the path of Tito and Jay, two brothers living in the Montreal neighborhood of Park Extension. Accompanying these young people in their daily life marked by complicity and intimidation, Star tackles themes dear to teenagers: identity and friendship.\",\n            \"popularity\": 1.817,\n            \"poster_path\": \"/hVGnSMBc42TGwvV5QTHpH0PgyJp.jpg\",\n            \"release_date\": \"2015-09-30\",\n            \"title\": \"Star\",\n            \"video\": false,\n            \"vote_average\": 5.788,\n            \"vote_count\": 33\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/5Iw7zQTHVRBOYpA0V6z0yypOPZh.jpg\",\n            \"genre_ids\": [\n                12,\n                28,\n                878\n            ],\n            \"id\": 181808,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Wars: The Last Jedi\",\n            \"overview\": \"A tranquila e solitária vida de Luke Skywalker sofre uma reviravolta quando ele conhece Rey, uma jovem que mostra fortes sinais da Força. O desejo dela de aprender o estilo dos Jedi força Luke a tomar uma decisão que mudará sua vida para sempre. Enquanto isso, Kylo Ren e o General Hux lideram a Primeira Ordem para um ataque total contra Leia e a Resistência pela supremacia da galáxia.\",\n            \"popularity\": 90.639,\n            \"poster_path\": \"/5dGufuaIG5vNcxPm8QPij5MSPeQ.jpg\",\n            \"release_date\": \"2017-12-13\",\n            \"title\": \"Star Wars: Episódio VIII - Os Últimos Jedi\",\n            \"video\": false,\n            \"vote_average\": 6.825,\n            \"vote_count\": 14311\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/jOzrELAzFxtMx2I4uDGHOotdfsS.jpg\",\n            \"genre_ids\": [\n                12,\n                28,\n                878\n            ],\n            \"id\": 181812,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Wars: The Rise of Skywalker\",\n            \"overview\": \"Com o retorno do Imperador Palpatine, todos voltam a temer seu poder e, com isso, a Resistência toma a frente da batalha que ditará os rumos da galáxia. Treinando para ser uma completa Jedi, Rey (Daisy Ridley) ainda se encontra em conflito com seu passado e futuro, mas teme pelas respostas que pode conseguir a partir de sua complexa ligação com Kylo Ren (Adam Driver), que também se encontra em conflito pela Força.\",\n            \"popularity\": 76.576,\n            \"poster_path\": \"/uLlrDUtFG2tKtDcJN6kBznlqqsp.jpg\",\n            \"release_date\": \"2019-12-18\",\n            \"title\": \"Star Wars: Episódio IX - A Ascensão Skywalker\",\n            \"video\": false,\n            \"vote_average\": 6.365,\n            \"vote_count\": 9047\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/8BTsTfln4jlQrLXUBquXJ0ASQy9.jpg\",\n            \"genre_ids\": [\n                12,\n                28,\n                878\n            ],\n            \"id\": 140607,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Wars: The Force Awakens\",\n            \"overview\": \"A queda de Darth Vader e do Império levou ao surgimento de uma nova força sombria: a Primeira Ordem. Eles procuram o jedi Luke Skywalker, desaparecido. A resistência tenta desesperadamente encontrá-lo antes para salvar a galáxia.\",\n            \"popularity\": 81.445,\n            \"poster_path\": \"/lqMDbo4rXnakFgc4C6LzPv6pG7F.jpg\",\n            \"release_date\": \"2015-12-15\",\n            \"title\": \"Star Wars: O Despertar da Força\",\n            \"video\": false,\n            \"vote_average\": 7.293,\n            \"vote_count\": 18352\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/npDrIM6ZbuD7nUxI7ZzNBxs4IRF.jpg\",\n            \"genre_ids\": [\n                28,\n                12,\n                878\n            ],\n            \"id\": 54138,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Trek Into Darkness\",\n            \"overview\": \"Os tripulantes da Enterprise descobrem uma força terrorista dentro da sua própria organização. O capitão Kirk desafia as regras da Frota Estelar e lidera uma missão para capturar uma arma de destruição em massa.\",\n            \"popularity\": 44.625,\n            \"poster_path\": \"/hHUHMuTwYBcQRMYK9z8jHZucnD3.jpg\",\n            \"release_date\": \"2013-05-05\",\n            \"title\": \"Além da Escuridão - Star Trek\",\n            \"video\": false,\n            \"vote_average\": 7.328,\n            \"vote_count\": 8589\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/ojHCeDULAkQK25700fhRU75Tur2.jpg\",\n            \"genre_ids\": [\n                878,\n                12,\n                28\n            ],\n            \"id\": 348350,\n            \"original_language\": \"en\",\n            \"original_title\": \"Solo: A Star Wars Story\",\n            \"overview\": \"Embarque na Millennium Falcon e viaje para uma galáxia distante em uma nova aventura com o mais amado canalha da galáxia. Através de uma série de ousadas aventuras no obscuro e perigoso submundo do crime, Han Solo encontra seu poderoso futuro copiloto Chewbacca e encontra o famoso jogador Lando Calrissian, em uma jornada que definirá o curso de um dos heróis mais improváveis da saga Star Wars.\",\n            \"popularity\": 84.484,\n            \"poster_path\": \"/jAMEX0syUh6sbjBiysibzrFpbo.jpg\",\n            \"release_date\": \"2018-05-15\",\n            \"title\": \"Han Solo: Uma História Star Wars\",\n            \"video\": false,\n            \"vote_average\": 6.563,\n            \"vote_count\": 7904\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/6t8ES1d12OzWyCGxBeDYLHoaDrT.jpg\",\n            \"genre_ids\": [\n                28,\n                12,\n                878\n            ],\n            \"id\": 330459,\n            \"original_language\": \"en\",\n            \"original_title\": \"Rogue One: A Star Wars Story\",\n            \"overview\": \"Em busca de uma nova esperança para a galáxia, a Aliança Rebelde enfrenta uma arriscada missão: roubar os planos que revelam uma falha na construção da Estrela da Morte. Para isso, eles contam com a ajuda de Jyn Erso, filha do criador da arma mais poderosa do império.\",\n            \"popularity\": 54.461,\n            \"poster_path\": \"/74C2YX0NLWnozVMRS56d5CKDdEv.jpg\",\n            \"release_date\": \"2016-12-14\",\n            \"title\": \"Rogue One: Uma História Star Wars\",\n            \"video\": false,\n            \"vote_average\": 7.488,\n            \"vote_count\": 14352\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/wDe8LzwuvHYYiuwyNfxdYQq8ti4.jpg\",\n            \"genre_ids\": [\n                12,\n                28,\n                878\n            ],\n            \"id\": 1893,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Wars: Episode I - The Phantom Menace\",\n            \"overview\": \"Enquanto resgatam a Rainha Amidala, governante de um planeta pacífico invadido por forças ameaçadoras, os Cavaleiros Jedi Obi-Wan Kenobi e Qui-Gon Jinn descobrem Anakin Skywalker, uma criança prodígio de 9 anos excepcionalmente poderosa na Força.\",\n            \"popularity\": 53.134,\n            \"poster_path\": \"/gNk8UNAumXlfCdtaxDqsQe7ZGlt.jpg\",\n            \"release_date\": \"1999-05-19\",\n            \"title\": \"Star Wars: Episódio I - A Ameaça Fantasma\",\n            \"video\": false,\n            \"vote_average\": 6.534,\n            \"vote_count\": 13550\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/5vDuLrjJXFS9PTF7Q1xzobmYKR9.jpg\",\n            \"genre_ids\": [\n                12,\n                28,\n                878\n            ],\n            \"id\": 1895,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Wars: Episode III - Revenge of the Sith\",\n            \"overview\": \"As Guerras Clônicas estão em pleno andamento e Anakin Skywalker mantém um elo de lealdade com Palpatine, ao mesmo tempo em que luta para que seu casamento com Padmé Amidala não seja afetado por esta situação. Seduzido por promessas de poder, Anakin se aproxima cada vez mais de Darth Sidious até se tornar o temível Darth Vader. Juntos eles tramam um plano para aniquilar de uma vez por todas com os cavaleiros jedi.\",\n            \"popularity\": 54.516,\n            \"poster_path\": \"/nuF5yWtTJEEAd4Qa6cVkYz1XCST.jpg\",\n            \"release_date\": \"2005-05-17\",\n            \"title\": \"Star Wars: Episódio III - A Vingança dos Sith\",\n            \"video\": false,\n            \"vote_average\": 7.411,\n            \"vote_count\": 12752\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/abwxHfymXGAbbH3lo9PDEJEfvtW.jpg\",\n            \"genre_ids\": [\n                12,\n                28,\n                878\n            ],\n            \"id\": 1894,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Wars: Episode II - Attack of the Clones\",\n            \"overview\": \"Com a missão de proteger a Senadora Amidala, Anakin Skywalker descobre o seu amor por ela, do mesmo modo que vai conhecendo seu lado sombrio. Obi-Wan Kenobi descobre um exército de clones à medida que a Galáxia caminha para uma grande guerra.\",\n            \"popularity\": 50.569,\n            \"poster_path\": \"/9m1nJ2MfTG5QEmjOCg0b4YCo4W8.jpg\",\n            \"release_date\": \"2002-05-15\",\n            \"title\": \"Star Wars: Episódio II - Ataque dos Clones\",\n            \"video\": false,\n            \"vote_average\": 6.551,\n            \"vote_count\": 12288\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/m4F1KRK5jAoQHi2mKDFE2jFKEIb.jpg\",\n            \"genre_ids\": [\n                28,\n                12,\n                878\n            ],\n            \"id\": 188927,\n            \"original_language\": \"en\",\n            \"original_title\": \"Star Trek Beyond\",\n            \"overview\": \"Desta vez, Kirk, Spock e a tripulação da Enterprise encontram-se no terceiro ano da missão de exploração do espaço prevista para durar cinco anos. Eles recebem um pedido de socorro que acaba os ligando ao maléfico vilão Krall, um insurgente Anti-Frota Estelar interessado em um objeto de posse do líder da nave. A Enterprise é atacada, e eles acabam em um planeta desconhecido, onde o grupo acaba sendo dividido em duplas.\",\n            \"popularity\": 56.142,\n            \"poster_path\": \"/zC2lEQjA4X814UnvekmdkM5hXmk.jpg\",\n            \"release_date\": \"2016-07-07\",\n            \"title\": \"Star Trek: Sem Fronteiras\",\n            \"video\": false,\n            \"vote_average\": 6.781,\n            \"vote_count\": 6226\n        },\n        {\n            \"adult\": false,\n            \"backdrop_path\": \"/fMRrTziefy0c6v45IUyByGjZCRo.jpg\",\n            \"genre_ids\": [\n                18\n            ],\n            \"id\": 970284,\n            \"original_language\": \"en\",\n            \"original_title\": \"Shooting Stars\",\n            \"overview\": \"Sonhando em viver do basquete, o jovem LeBron James começa sua trajetória com o time de sua escola. Com seus amigos e colegas de time, ele alcança o posto entre os melhores jogadores do mundo.\",\n            \"popularity\": 23.106,\n            \"poster_path\": \"/rzOxUgqkQeKyhyuKZqIj87VqFUg.jpg\",\n            \"release_date\": \"2023-06-02\",\n            \"title\": \"Shooting Stars: A Vida de Lebron James\",\n            \"video\": false,\n            \"vote_average\": 8.2,\n            \"vote_count\": 84\n        }\n    ],\n    \"total_pages\": 225,\n    \"total_results\": 4486\n}",
        "output": "json",
        "x": 440,
        "y": 220,
        "wires": [
            [
                "34d013ba59765ca4"
            ]
        ]
    },
    {
        "id": "380f8812037194a2",
        "type": "ui_button",
        "z": "aa0e170c91379e2f",
        "name": "",
        "group": "9b81770e912bf6fa",
        "order": 1,
        "width": "6",
        "height": "1",
        "passthru": false,
        "label": "Salvar em Meus Filmes",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "payload",
        "payloadType": "flow",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 520,
        "wires": [
            [
                "4fe249d2ec9aba2b"
            ]
        ]
    },
    {
        "id": "8670c986165804cd",
        "type": "comment",
        "z": "aa0e170c91379e2f",
        "name": "Busca de filmes",
        "info": "",
        "x": 440,
        "y": 40,
        "wires": []
    },
    {
        "id": "5a5e8e7e5d247047",
        "type": "comment",
        "z": "aa0e170c91379e2f",
        "name": "Verifica se filme já está salvo",
        "info": "",
        "x": 580,
        "y": 420,
        "wires": []
    },
    {
        "id": "a4eb3f59a2b5cb7f",
        "type": "function",
        "z": "aa0e170c91379e2f",
        "name": "define url buscar filme",
        "func": "const API_MOVIE_BASEURL = env.get('API_MOVIE_BASEURL');\nconst API_MOVIE_TOKEN = env.get('API_MOVIE_TOKEN');\n\nconst movieName = encodeURIComponent(msg.payload.movieName);\n\nmsg.payload.url = `${API_MOVIE_BASEURL}?query=${movieName}}}&include_adult=false&language=pt-BR&page=1`;\n\nmsg.payload.token = `Bearer ${API_MOVIE_TOKEN}`;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 240,
        "y": 80,
        "wires": [
            [
                "20505872b4e45f34"
            ]
        ]
    },
    {
        "id": "824ccd2f271148e9",
        "type": "change",
        "z": "aa0e170c91379e2f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 890,
        "y": 300,
        "wires": [
            [
                "380f8812037194a2"
            ]
        ]
    },
    {
        "id": "e79d60429faa265f",
        "type": "http request",
        "z": "aa0e170c91379e2f",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "${API_DB_MOVIE}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 680,
        "y": 940,
        "wires": [
            [
                "e2daa6eef4116ac9"
            ]
        ]
    },
    {
        "id": "e410aaea38bbd813",
        "type": "function",
        "z": "aa0e170c91379e2f",
        "name": "Payload inserir filme",
        "func": "let msgPayload = flow.get('payload');\n\nconst now = new Date();\n\nconst year = now.getFullYear();\nconst month = String(now.getMonth() + 1).padStart(2, '0');\nconst day = String(now.getDate()).padStart(2, '0');\nconst hour = String(now.getHours()).padStart(2, '0');\nconst minute = String(now.getMinutes()).padStart(2, '0');\nconst second = String(now.getSeconds()).padStart(2, '0');\n\nconst formattedDateTime = `${year}-${month}-${day} ${hour}:${minute}:${second}`;\n\nmsg.payload = {\n    api_id: msgPayload.id,\n    nome: msgPayload.title,\n    data_criacao: formattedDateTime,\n    data_atualizacao: formattedDateTime\n}\n\nreturn msg;\n",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 420,
        "y": 940,
        "wires": [
            [
                "e79d60429faa265f"
            ]
        ]
    },
    {
        "id": "e2daa6eef4116ac9",
        "type": "switch",
        "z": "aa0e170c91379e2f",
        "name": "",
        "property": "statusCode",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "200",
                "vt": "num"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 910,
        "y": 940,
        "wires": [
            [
                "5712d843bc58084d"
            ],
            []
        ]
    },
    {
        "id": "4251b54d511ce29b",
        "type": "http request",
        "z": "aa0e170c91379e2f",
        "name": "",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://sheet.best/api/sheets/c66e622b-ba4f-415b-8d47-ee62f8257070/tabs/usuarios_filmes",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 1640,
        "y": 820,
        "wires": [
            []
        ]
    },
    {
        "id": "4e9ab0227ea4e448",
        "type": "function",
        "z": "aa0e170c91379e2f",
        "name": "Payload vincular usuario a filme",
        "func": "\nconsole.log('aqui no nó de vincular usuario e fulme 1');\nconsole.log(msg);\n\nconst uuid = global.get('uuid');\n\nconst filmeData = flow.get('payload');\n\nconst now = new Date();\n\nconst year = now.getFullYear();\nconst month = String(now.getMonth() + 1).padStart(2, '0');\nconst day = String(now.getDate()).padStart(2, '0');\nconst hour = String(now.getHours()).padStart(2, '0');\nconst minute = String(now.getMinutes()).padStart(2, '0');\nconst second = String(now.getSeconds()).padStart(2, '0');\n\nconst formattedDateTime = `${year}-${month}-${day} ${hour}:${minute}:${second}`;\n\nmsg.payload = {\n    id: uuid.v4(),\n    usuario_id: msg.token?.id,\n    api_id: filmeData.id,\n    data_criacao: formattedDateTime,\n    data_atualizacao: formattedDateTime\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1430,
        "y": 740,
        "wires": [
            [
                "4251b54d511ce29b"
            ]
        ]
    },
    {
        "id": "39ca274aec7246c5",
        "type": "JsonWebToken",
        "z": "aa0e170c91379e2f",
        "name": "decode token",
        "tokenconfig": "cf21394ef4fb9045",
        "x": 1220,
        "y": 820,
        "wires": [
            [
                "4e9ab0227ea4e448"
            ]
        ]
    },
    {
        "id": "5712d843bc58084d",
        "type": "change",
        "z": "aa0e170c91379e2f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "token",
                "pt": "msg",
                "to": "token",
                "tot": "global"
            },
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1040,
        "y": 740,
        "wires": [
            [
                "39ca274aec7246c5"
            ]
        ]
    },
    {
        "id": "b9ebd0efa64515db",
        "type": "http request",
        "z": "aa0e170c91379e2f",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "{{{payload.url}}}",
        "tls": "",
        "persist": false,
        "proxy": "",
        "insecureHTTPParser": false,
        "authType": "",
        "senderr": false,
        "headers": [],
        "x": 880,
        "y": 520,
        "wires": [
            [
                "7e56a9fd7f8f462d"
            ]
        ]
    },
    {
        "id": "4fe249d2ec9aba2b",
        "type": "change",
        "z": "aa0e170c91379e2f",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload",
                "tot": "flow"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 520,
        "wires": [
            [
                "e247c872801cf633"
            ]
        ]
    },
    {
        "id": "e247c872801cf633",
        "type": "function",
        "z": "aa0e170c91379e2f",
        "name": "URL com o filme no database",
        "func": "const url = `https://sheet.best/api/sheets/c66e622b-ba4f-415b-8d47-ee62f8257070/api_id/${msg.payload.id}`;\n\nmsg.payload.url = url;\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 650,
        "y": 600,
        "wires": [
            [
                "b9ebd0efa64515db"
            ]
        ],
        "info": "montar URL que verifica o filme no banco de dados"
    },
    {
        "id": "7e56a9fd7f8f462d",
        "type": "function",
        "z": "aa0e170c91379e2f",
        "name": "function 2",
        "func": "msg.payload = JSON.parse(msg.payload);\n\nmsg.filme_existe = false;\n\nif(msg.payload.length > 0) {\n    msg.payload = msg.payload[0];\n    msg.filme_existe = true;\n}\n\nreturn msg;",
        "outputs": 1,
        "timeout": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 980,
        "y": 640,
        "wires": [
            [
                "44b2873882ca00db"
            ]
        ]
    },
    {
        "id": "44b2873882ca00db",
        "type": "switch",
        "z": "aa0e170c91379e2f",
        "name": "",
        "property": "filme_existe",
        "propertyType": "msg",
        "rules": [
            {
                "t": "true"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 270,
        "y": 760,
        "wires": [
            [
                "5712d843bc58084d"
            ],
            [
                "e410aaea38bbd813"
            ]
        ]
    },
    {
        "id": "280d78b1a787b1d8",
        "type": "comment",
        "z": "aa0e170c91379e2f",
        "name": "Salvar filmes",
        "info": "",
        "x": 690,
        "y": 720,
        "wires": []
    },
    {
        "id": "04aa548983effda0",
        "type": "ui_template",
        "z": "c4bb2b1dcfa16364",
        "group": "a6d03c119ba764d7",
        "name": "",
        "order": 1,
        "width": 0,
        "height": 0,
        "format": "<style>\n    a,button {\n        cursor: pointer;\n    }\n    .w{\n    width: 100%;\n    }\n</style>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "global",
        "className": "",
        "x": 120,
        "y": 60,
        "wires": [
            []
        ]
    }
]